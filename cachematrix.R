# Matrix inversion is usually a costly computation and there may be some benefit
# to caching the inverse of a matrix rather than compute it repeatedly. The
# following two functions are used to cache the inverse of a matrix.

# makeCacheMatrix creates a list containing a function to
# 1. set the value of the matrix
# 2. get the value of the matrix
# 3. set the value of inverse of the matrix
# 4. get the value of inverse of the matrix
makeCacheMatrix <- function(x = matrix()) {
        inv <- NULL
        set <- function(y) {
                x <<- y
                inv <<- NULL
        }
        get <- function() x
        setinverse <- function(inverse) inv <<- inverse
        getinverse <- function() inv
        list(set=set, get=get, setinverse=setinverse, getinverse=getinverse)
}

# This function computes the inverse of the special
# "matrix" returned by `makeCacheMatrix` above. 
# If the inverse has already been calculated (and the matrix has not changed),
# then `cacheSolve` should retrieve the inverse from the cache.

# Assume matrix is square and invertible
cacheSolve <- function(x, ...) {
        inv <- x$getinverse()
        if(!is.null(inv)) {
                message("getting cached data.")
                return(inv)
        }
        data <- x$get()
        inv <- solve(data)
        x$setinverse(inv)
        inv
}

# Sample Output:

# x<-matrix(rnorm(100),10)
# > x
# [,1]       [,2]       [,3]        [,4]       [,5]       [,6]
# [1,]  1.2321481 -1.1389602 -1.9053015  0.04990708  1.9856767 -1.6097815
# [2,] -0.9232490 -0.1807784 -0.9812017  0.24392338  1.7441429  0.8869721
# [3,] -1.4077017 -0.6088326 -0.2052892  1.60757580  0.6582725 -0.2693499
# [4,]  0.2610153  1.9162341 -0.3752534  0.55231286 -1.1749178 -0.6649698
# [5,] -1.8740511 -0.4002486 -0.9614047 -1.36509281 -1.8508210  0.6675411
# [6,] -2.1149513 -0.3481650 -0.7272891 -1.66827069  0.3245076  0.7987046
# [7,] -2.5914586 -0.2498909  0.2703567 -0.06804258  0.2470649 -0.1739767
# [8,] -0.7675310 -0.6214369 -1.2415018 -0.86628886  0.1058898 -1.5614688
# [9,] -0.8328266  0.1265398  0.3322577  1.24737342 -1.7301635  2.0047931
# [10,]  0.2665762 -0.9485017 -0.6599382 -0.89299410 -1.7048204 -0.5255333
# [,7]       [,8]       [,9]       [,10]
# [1,] -0.93797188 -2.5259375 -1.2013220  0.30947813
# [2,]  0.97303464 -0.8438547  0.6451467 -2.17352463
# [3,]  0.04112587 -1.0059102  0.5727473  0.27834657
# [4,]  0.26330101 -0.9912201  0.1458432  0.22201220
# [5,] -0.70410018 -0.5310706 -0.1564737 -1.54577402
# [6,] -0.14819559  0.7967305 -1.0924712 -1.54383524
# [7,]  1.03113322  0.5769438  0.1464994  0.84978833
# [8,]  0.45617842  1.7810850  0.2867315  2.80196465
# [9,]  0.22503926  0.6816511  0.7741025  1.07442719
# [10,]  0.61720046 -1.0085098  1.6897596  0.01387383
# > m<-makeCacheMatrix(x)
# > cacheSolve(m)
# [,1]       [,2]       [,3]       [,4]      [,5]      [,6]
# [1,] -0.025296260 -0.4304518  0.5035276  0.3009420 -1.133202  1.322953
# [2,]  0.115885274  1.3681088 -1.9615383 -0.5774090  2.768882 -3.732319
# [3,]  0.008221431  0.3438144 -0.8924305 -0.5798659  1.185231 -1.802111
# [4,] -0.345921696 -1.6130908  2.7935605  1.2208362 -3.531858  4.729815
# [5,]  0.225620806  1.4350650 -1.9122280 -1.0129789  2.693546 -3.789840
# [6,]  0.336946634  1.0860226 -1.7551762 -0.7771227  2.023309 -2.773138
# [7,] -0.140709743 -1.7491955  2.3834189  1.4832647 -4.411726  5.615456
# [8,] -0.420740676 -0.8666857  1.5356662  0.5865986 -1.964073  2.737205
# [9,]  0.019002511  2.0165508 -2.4667244 -1.4017581  4.096462 -5.584527
# [10,]  0.383121988  1.0194493 -1.8464612 -0.7908110  2.310172 -3.286401
# [,7]        [,8]        [,9]      [,10]
# [1,] -0.6848022 -0.16712032  0.18283669  0.7040707
# [2,]  1.4026222  0.49548286 -0.39452627 -1.9068291
# [3,]  0.9818626 -0.10703864 -0.32789297 -0.7449892
# [4,] -2.0859396 -0.49495707  0.48902087  2.0893875
# [5,]  1.4794737  0.47879333 -0.42224330 -1.8687952
# [6,]  1.2002590  0.21458464  0.14966268 -1.3276746
# [7,] -1.6706037 -0.80195081  0.67591001  2.8251933
# [8,] -1.4028540 -0.03756047  0.14942693  1.1079689
# [9,]  1.8029816  0.81819176 -0.65650980 -2.4331115
# [10,]  1.5058084  0.39275100 -0.06999284 -1.4986754
